<html>
<body>
    aoc6disp
    <canvas id="Canvas1" width="1500" height="1500" style="border: 1px solid black;">
<script>
var c1 = document.getElementById("Canvas1");
var ct1 = c1.getContext("2d");
    var ins=[], grid=[],disp=[]
  fileLoad();
    async function fileLoad() {
  try {
    const response = await fetch('info16.txt');
    var data = await response.text();
   
    ins = data.split('\n');
  } catch (error) {
    alert('Error reading file:'+error);
  }
     
ins.pop()
 start()      
    }
var dir=0,m=0,sc=8,kill=0
var okRL=[".","-"], okUD=[".","|"]
var t=1
function start(){
display(0)
    t=prompt("Enter time delay")
var n={x:0,y:0}
setTimeout(function(){move(0,0,0,0)},500)   
}
function move(d1,a1,b1,c1){
    setTimeout(function(){mov2(d1,a1,b1,c1)},t)
}
function mov2(d,a,b,kc){
    var ac=0
    m++
    ct1.clearRect(100,0,200,9)
    ct1.fillText(m+"  k="+kill,100,9)
    if( a<0 || a>=ins[0].length || b<0 || b>=ins.length){return}
    show(d,a,b)
    if(grid[b][a]=="x"){ac=kc+1}
    if(ac>600){kill++;return}
    if(Math.random()<.00001){alert(ac)}
    grid[b][a]="x"
    //if(m%8000==1000){alert(coun() )}
    ch=disp[b][a]
    if(d==0){
        if( okRL.includes(ch) ){ move(0,a+1,b,ac); return}
        else{
         if(ch=="/"){ move(3,a,b-1,ac); return}
         if(ch=="\\"){ move(1,a,b+1,ac); return}
         if(ch=="|"){ setTimeout(function(){move(1,a,b+1,ac)},1);
                     setTimeout(function(){move(3,a,b-1,ac)},1);
                     disp[b][a]="/"
                    return}
        }
    }
    
     if(d==1){
        
        if( okUD.includes(ch) ){ move(1,a,b+1,ac); return}
        else{
         if(ch=="/"){ move(2,a-1,b,ac); return}
         if(ch=="\\"){ move(0,a+1,b,ac); return}
         if(ch=="-"){ setTimeout(function(){move(0,a+1,b,ac)},1);
                    setTimeout(function(){move(2,a-1,b,ac)},1);
                    disp[b][a]="/"
                     return}
        } 
    }
    
     if(d==2){
        if( okRL.includes(ch) ){ move(2,a-1,b,ac); return}
        else{
         if(ch=="/"){ move(1,a,b+1,ac); return}
         if(ch=="\\"){ move(3,a,b-1,ac); return}
         if(ch=="|"){ setTimeout(function(){move(1,a,b+1,ac)},1);
                     setTimeout(function(){move(3,a,b-1,ac)},1);
                     disp[b][a]="/"
                     return}
        }
    }
    
    if(d==3){
        if( okUD.includes(ch) ){ move(3,a,b-1,ac); return}
        else{
         if(ch=="/"){ move(0,a+1,b,ac); return}
         if(ch=="\\"){ move(2,a-1,b,ac); return}
         if(ch=="-"){ setTimeout(function(){move(0,a+1,b,ac)},1);
                    setTimeout(function(){move(2,a-1,b,ac)},1);
                     disp[b][a]="/"
                    return}
        }
    }

    
}

function show(di,p,q){  
    if (di==0){ct1.fillStyle="blue"}
    if (di==1){ct1.fillStyle="green"}
    if (di==2){ct1.fillStyle="red"}
    if (di==3){ct1.fillStyle="brown"}
ct1.fillText("*",10+sc*p,15+sc*q)
}
  
function display(z){
    ct1.font="10px Monospace"
   ct1.clearRect(0,20,800,800)
    for(k=0;k<ins.length;k++){
      if(z==0){grid[k]=ins[k].split(""); disp=insk[k].split("")}
      for(j=0;j<ins[k].length;j++){
         ct1.fillText(disp[k][j], 10+sc*j, 15+sc*k)
      }
    }
    ct1.font="12px Monospace"
}
function coun(){
    var co=0
     for(k=0;k<grid.length;k++){
      for(j=0;j<grid[0].length;j++){
         if(grid[k][j]=="x"){co++}
      }
    }
    return co
}
</script>
</body>
</html>

